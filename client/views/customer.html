<div ng-include src="'views/breadcrumb.html'"></div>

<md-content>

  <div layout="row" class="background">

    <div class="col-md-3  sidebar-container" layout-margin>
      <sidebar style="height:100%" model="customer" type="'customer'"
        add-license-function="addLicense"
        show-license-function="showLicense"
        add-filter-function="addFilter"
        edit-filter-function="editFilter"
        action-filter-function="actionFilter"
        delete-function="deleteCustomer"
        software-versions="softwareVersions"
        filters="filters"
        can-modify-event-url-function="canModifyEventUrl"
        can-modify-image-server-url-function="canModifyImageServerUrl"
        create-software-version-function="openSoftwareVersionForm"
        can-modify-software-version-function="canModifySoftwareVersion"
        can-modify-checkin-interval-function="canModifyCheckinInterval"
        can-modify-signalling-server-function="canModifySignallingServer"
        children="children"
        load-filters="loadFilters"
        owned-filters="ownedFilters"
        cascaded-filters="cascadedFilters"
        filter-changed-function="filterChanged"
      />
    </div>

    <div class="child-list col-md-8" layout-margin layout-fill layout-padding>
      <h2>Devices</h2>
      <input type="text" class="device-search form-control" placeholder="Search" ng-model="searchFilter">

      <md-tabs md-dynamic-height>
        <md-tab label="LIST">
          <md-content class="card">
            <table class="device-table" width="100%" style="margin: 0px;">
            <tr>
              <th align="left" ng-click="changeSorting('name')">Device Name</th>
              <th align="left" ng-click="changeSorting('address')">Address</th>
              <th align="left" ng-click="changeSorting('onlineStatus')">Status</th>
              <th align="left"></th>
              <th align="left" ng-click="changeSorting('status')">Camera Status</th>
              <th align="left"></th>
            </tr>
            <tr class="device-table-row" ng-repeat="device in customer.devices | orderBy: sort.column:sort.descending | filter: searchFilter" ng-click="selectDevice(device)">
              <td>{{device.name}}</td>
              <td>{{device.address}}</td>
              <td ng-style="setDeviceStatusStyling(device)">{{device.onlineStatus}}</td>
              <td>
                <md-icon md-svg-icon="checkmark" md-menu-align-target ng-show="device.onlineStatus=='Online'"></md-icon>
                <md-icon md-svg-icon="error" md-menu-align-target ng-show="device.onlineStatus=='Offline'"></md-icon>
                <md-icon md-svg-icon="warning" md-menu-align-target ng-show="device.onlineStatus=='Unknown'"></md-icon>
              </td>
              <td ng-style="setCameraStatusStyling(device)">{{device.onlineCameraCount}}/{{device.cameras.length}} Online</td>
              <td>
               <md-icon md-svg-icon="checkmark" md-menu-align-target ng-show="device.status=='green'"></md-icon>
                 <md-icon md-svg-icon="error" md-menu-align-target ng-show="device.status=='red'"></md-icon>
                 <md-icon md-svg-icon="warning" md-menu-align-target ng-show="device.status=='yellow'"></md-icon> 
  <!--              <md-icon md-svg-icon="checkmark" md-menu-align-target ng-show="device.statusIconColor=='green'"></md-icon>
                <md-icon md-svg-icon="error" md-menu-align-target ng-show="device.statusIconColor=='red'"></md-icon>
                <md-icon md-svg-icon="warning" md-menu-align-target ng-show="device.statusIconColor=='yellow'"></md-icon> -->
              </td>
            </tr>
            </table>
          </md-content>
        </md-tab>

        <md-tab label="MAP">
          <md-content style="height:600px;">

            <ui-gmap-google-map center='map.center' zoom='map.zoom'>
              <ui-gmap-markers models="markers" coords="'self'" icon="'icon'" click="onMarkerClicked" options="'options'" events="map.markers2Events" fit="true">
                <ui-gmap-windows show="'showWindow'" closeClick="'closeClick'" ng-cloak>
                  <div>
                      <b ng-non-bindable >{{ customerName }}</b><br>
                      <br>
                      <a ng-click="model.selectDevice(model.deviceId)" style="text-decoration:underline;"><span ng-non-bindable>{{ deviceName }}</span></a>
                  </div>
                </ui-gmap-windows>
              </ui-gmap-markers>
            </ui-gmap-google-map>
          </md-content>
        </md-tab>
      </md-tabs>
    </div>
  </div>

</md-content>
